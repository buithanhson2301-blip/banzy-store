(()=>{var e={};e.id=923,e.ids=[923],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},358:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},2960:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>o,pages:()=>h,routeModule:()=>m,tree:()=>d});var a=t(7),r=t(8533),l=t(9377),n=t.n(l),i=t(9799),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["customers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,218)),"D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\dashboard\\customers\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3723)),"D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,364)),"D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,3472,23)),"next/dist/client/components/not-found-error"]}],h=["D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\dashboard\\customers\\page.tsx"],o="/dashboard/customers/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/customers/page",pathname:"/dashboard/customers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4451:(e,s,t)=>{Promise.resolve().then(t.bind(t,9221))},9221:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(4714),r=t(7580),l=t(6164),n=t(155),i=t(3682),c=t(5717),d=t(5208),h=t(8387),o=t(1102),x=t(4583),m=t(5082);function u(){let[e,s]=(0,r.useState)([]),[t,u]=(0,r.useState)(!0),[p,j]=(0,r.useState)(""),[g,b]=(0,r.useState)(!1),[f,N]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),[k,C]=(0,r.useState)(null),[w,q]=(0,r.useState)([]),[D,P]=(0,r.useState)({name:"",email:"",phone:"",address:""}),[S,_]=(0,r.useState)([{level:0,name:"Thường",minSpent:0,minOrders:0,color:"#9CA3AF"},{level:1,name:"Bạc",minSpent:2e6,minOrders:5,color:"#94A3B8"},{level:2,name:"V\xe0ng",minSpent:1e7,minOrders:20,color:"#EAB308"},{level:3,name:"Kim cương",minSpent:5e7,minOrders:50,color:"#06B6D4"}]),T=async()=>{try{let{data:e}=await o.v2.get();e.tiers&&_(e.tiers)}catch(e){console.error("Failed to fetch tier settings:",e)}},A=async()=>{try{let{data:e}=await o.fU.getAll({search:p,limit:100});s(e.customers)}catch(e){console.error("Failed to fetch customers:",e)}finally{u(!1)}};(0,r.useEffect)(()=>{A(),T()},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>A(),300);return()=>clearTimeout(e)},[p]);let G=e=>{e?(C(e),P({name:e.name,email:e.email||"",phone:e.phone,address:e.address||""})):(C(null),P({name:"",email:"",phone:"",address:""})),b(!0)},Z=async e=>{try{let{data:s}=await o.fU.getOrders(e._id);q(s),C(e),N(!0)}catch(e){m.default.error("Kh\xf4ng thể tải lịch sử đơn h\xe0ng")}},E=async e=>{e.preventDefault();try{k?(await o.fU.update(k._id,D),m.default.success("Đ\xe3 cập nhật kh\xe1ch h\xe0ng")):(await o.fU.create(D),m.default.success("Đ\xe3 th\xeam kh\xe1ch h\xe0ng mới")),b(!1),A()}catch(e){m.default.error(e.message||"C\xf3 lỗi xảy ra")}},H=async e=>{if(confirm(`Bạn c\xf3 chắc muốn x\xf3a "${e.name}"?`))try{await o.fU.delete(e._id),m.default.success("Đ\xe3 x\xf3a kh\xe1ch h\xe0ng"),A()}catch(e){m.default.error(e.message||"C\xf3 lỗi xảy ra")}},M=async()=>{try{await o.v2.update(S),m.default.success("Đ\xe3 lưu c\xe0i đặt ph\xe2n hạng"),y(!1),A()}catch(e){m.default.error(e.message||"C\xf3 lỗi xảy ra")}},O=e=>S.find(s=>s.level===e)||S[0];return(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Kh\xe1ch h\xe0ng"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{className:"btn btn-secondary",onClick:()=>y(!0),children:[a.jsx(l.Z,{className:"w-5 h-5"})," Ph\xe2n hạng"]}),(0,a.jsxs)("button",{className:"btn btn-primary",onClick:()=>G(),children:[a.jsx(n.Z,{className:"w-5 h-5"})," Th\xeam kh\xe1ch h\xe0ng"]})]})]}),(0,a.jsxs)("div",{className:"relative max-w-md",children:[a.jsx(i.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-dark-500"}),a.jsx("input",{type:"text",className:"input pl-10",placeholder:"T\xecm kiếm kh\xe1ch h\xe0ng...",value:p,onChange:e=>j(e.target.value)})]}),a.jsx("div",{className:"table-container",children:t?a.jsx("div",{className:"p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===e.length?a.jsx("div",{className:"p-8 text-center text-dark-500",children:p?"Kh\xf4ng t\xecm thấy kh\xe1ch h\xe0ng":"Chưa c\xf3 kh\xe1ch h\xe0ng n\xe0o"}):(0,a.jsxs)("table",{className:"table",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{children:"Kh\xe1ch h\xe0ng"}),a.jsx("th",{children:"Điện thoại"}),a.jsx("th",{children:"Hạng"}),a.jsx("th",{children:"Đơn h\xe0ng"}),a.jsx("th",{children:"Chi ti\xeau"}),a.jsx("th",{children:"Thao t\xe1c"})]})}),a.jsx("tbody",{children:e.map(e=>{let s=O(e.tier||0);return(0,a.jsxs)("tr",{children:[a.jsx("td",{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-primary-500/20 rounded-full flex items-center justify-center text-primary-400 font-medium",children:e.name.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:e.name}),a.jsx("p",{className:"text-sm text-dark-500 truncate max-w-[200px]",children:e.address||"-"})]})]})}),a.jsx("td",{children:e.phone}),a.jsx("td",{children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:s.color+"30",color:s.color},children:s.name})}),a.jsx("td",{children:(0,a.jsxs)("span",{className:"badge badge-primary",children:[e.totalOrders," đơn"]})}),a.jsx("td",{className:"font-medium text-green-400",children:(0,x.xG)(e.totalSpent)}),a.jsx("td",{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{className:"btn btn-ghost p-2",onClick:()=>Z(e),title:"Xem đơn h\xe0ng",children:a.jsx(c.Z,{className:"w-4 h-4"})}),a.jsx("button",{className:"btn btn-ghost p-2",onClick:()=>G(e),children:a.jsx(d.Z,{className:"w-4 h-4"})}),a.jsx("button",{className:"btn btn-ghost p-2 text-red-400",onClick:()=>H(e),children:a.jsx(h.Z,{className:"w-4 h-4"})})]})})]},e._id)})})]})}),g&&a.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-lg",children:[a.jsx("div",{className:"p-4 border-b border-dark-800",children:a.jsx("h2",{className:"text-lg font-semibold",children:k?"Sửa kh\xe1ch h\xe0ng":"Th\xeam kh\xe1ch h\xe0ng mới"})}),(0,a.jsxs)("form",{onSubmit:E,className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Họ t\xean *"}),a.jsx("input",{className:"input",required:!0,value:D.name,onChange:e=>P({...D,name:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Điện thoại *"}),a.jsx("input",{className:"input",required:!0,value:D.phone,onChange:e=>P({...D,phone:e.target.value})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Email"}),a.jsx("input",{type:"email",className:"input",value:D.email,onChange:e=>P({...D,email:e.target.value})})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Địa chỉ"}),a.jsx("textarea",{className:"input",rows:2,value:D.address,onChange:e=>P({...D,address:e.target.value})})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",className:"btn btn-secondary flex-1",onClick:()=>b(!1),children:"Hủy"}),a.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:k?"Cập nhật":"Th\xeam mới"})]})]})]})}),f&&k&&(()=>{let e=O(k.tier||0);return a.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-dark-800 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"\uD83D\uDC64 Chi tiết kh\xe1ch h\xe0ng"}),a.jsx("button",{className:"btn btn-ghost p-2",onClick:()=>N(!1),children:"✕"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 bg-primary-500/20 rounded-full flex items-center justify-center text-primary-400 text-2xl font-bold",children:k.name.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:k.name}),(0,a.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium inline-flex items-center gap-1",style:{backgroundColor:e.color+"30",color:e.color},children:["⭐ ",e.name]})]})]}),(0,a.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-dark-400 w-24",children:"\uD83D\uDCDE SĐT:"}),a.jsx("span",{className:"font-medium",children:k.phone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-dark-400 w-24",children:"\uD83D\uDCE7 Email:"}),a.jsx("span",{className:"font-medium",children:k.email||"-"})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"text-dark-400 w-24",children:"\uD83D\uDCCD Địa chỉ:"}),a.jsx("span",{className:"font-medium",children:k.address||"-"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-dark-400 text-sm",children:"Tổng đơn h\xe0ng"}),a.jsx("p",{className:"text-3xl font-bold text-primary-400",children:k.totalOrders})]}),(0,a.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-dark-400 text-sm",children:"Tổng chi ti\xeau"}),a.jsx("p",{className:"text-2xl font-bold text-green-400",children:(0,x.xG)(k.totalSpent)})]}),(0,a.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center col-span-2",children:[a.jsx("p",{className:"text-dark-400 text-sm",children:"Hạng th\xe0nh vi\xean"}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83C\uDFC6"}),a.jsx("span",{className:"text-xl font-bold",style:{color:e.color},children:e.name})]}),a.jsx("p",{className:"text-xs text-dark-500 mt-1",children:e.level<3?`C\xf2n ${(0,x.xG)(S[e.level+1]?.minSpent-k.totalSpent)} hoặc ${S[e.level+1]?.minOrders-k.totalOrders} đơn để l\xean hạng`:"Hạng cao nhất!"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:["\uD83D\uDCE6 Lịch sử đơn h\xe0ng (",w.length,")"]}),0===w.length?a.jsx("div",{className:"p-6 text-center text-dark-500 bg-dark-800 rounded-lg",children:"Chưa c\xf3 đơn h\xe0ng n\xe0o"}):a.jsx("div",{className:"bg-dark-800 rounded-lg overflow-hidden",children:(0,a.jsxs)("table",{className:"table",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{children:"M\xe3 đơn"}),a.jsx("th",{children:"Ng\xe0y"}),a.jsx("th",{children:"Tổng tiền"}),a.jsx("th",{children:"Trạng th\xe1i"})]})}),a.jsx("tbody",{children:w.map(e=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"font-medium",children:e.orderCode}),a.jsx("td",{children:(0,x.p6)(e.createdAt)}),a.jsx("td",{className:"font-medium",children:(0,x.xG)(e.total)}),a.jsx("td",{children:a.jsx("span",{className:`badge badge-${x.AQ[e.status]}`,children:x.cL[e.status]})})]},e._id))})]})})]})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-dark-800 flex gap-3",children:[a.jsx("button",{className:"btn btn-secondary flex-1",onClick:()=>N(!1),children:"Đ\xf3ng"}),a.jsx("button",{className:"btn btn-primary flex-1",onClick:()=>{N(!1),G(k)},children:"✏️ Chỉnh sửa"})]})]})})})(),v&&a.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-2xl",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-dark-800",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"⚙️ C\xe0i đặt ph\xe2n hạng kh\xe1ch h\xe0ng"}),a.jsx("p",{className:"text-sm text-dark-400 mt-1",children:"Kh\xe1ch h\xe0ng sẽ l\xean hạng khi đạt 1 trong 2 điều kiện (chi ti\xeau HOẶC số đơn)"})]}),a.jsx("div",{className:"p-4 space-y-4",children:S.map((e,s)=>(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3 items-end p-3 bg-dark-800 rounded-lg",style:{borderLeft:`4px solid ${e.color}`},children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label text-xs",children:"T\xean hạng"}),a.jsx("input",{className:"input",value:e.name,onChange:e=>{let t=[...S];t[s].name=e.target.value,_(t)}})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label text-xs",children:"Chi ti\xeau tối thiểu"}),a.jsx("input",{type:"text",className:"input",disabled:0===e.level,value:e.minSpent?e.minSpent.toLocaleString("vi-VN"):"0",onChange:e=>{let t=e.target.value.replace(/\./g,"").replace(/[^0-9]/g,""),a=[...S];a[s].minSpent=parseInt(t)||0,_(a)}})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label text-xs",children:"Số đơn tối thiểu"}),a.jsx("input",{type:"number",className:"input",disabled:0===e.level,value:e.minOrders,onChange:e=>{let t=[...S];t[s].minOrders=parseInt(e.target.value)||0,_(t)}})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label text-xs",children:"M\xe0u"}),a.jsx("input",{type:"color",className:"input h-10 p-1",value:e.color,onChange:e=>{let t=[...S];t[s].color=e.target.value,_(t)}})]})]},e.level))}),(0,a.jsxs)("div",{className:"p-4 border-t border-dark-800 flex gap-3",children:[a.jsx("button",{className:"btn btn-secondary flex-1",onClick:()=>{T(),y(!1)},children:"Hủy"}),a.jsx("button",{className:"btn btn-primary flex-1",onClick:M,children:"\uD83D\uDCBE Lưu c\xe0i đặt"})]})]})})]})}},5717:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9858).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5208:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9858).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},155:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9858).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3682:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9858).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},8387:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9858).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},218:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>r,default:()=>n});let a=(0,t(1481).createProxy)(String.raw`D:\APP\Test app QLBH w GG\frontend\src\app\dashboard\customers\page.tsx`),{__esModule:r,$$typeof:l}=a,n=a.default}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[100,766,59,712,5],()=>t(2960));module.exports=a})();