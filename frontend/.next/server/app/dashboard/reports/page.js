(()=>{var e={};e.id=1,e.ids=[1],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},358:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1617:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>c});var r=s(7),a=s(8533),n=s(9377),l=s.n(n),i=s(9799),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let c=["",{children:["dashboard",{children:["reports",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7080)),"D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\dashboard\\reports\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3723)),"D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,364)),"D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,3472,23)),"next/dist/client/components/not-found-error"]}],o=["D:\\APP\\Test app QLBH w GG\\frontend\\src\\app\\dashboard\\reports\\page.tsx"],x="/dashboard/reports/page",h={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/reports/page",pathname:"/dashboard/reports",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4318:(e,t,s)=>{Promise.resolve().then(s.bind(s,5419))},5419:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(4714),a=s(7580),n=s(9858);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,n.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),i=(0,n.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);var d=s(620),c=s(4089),o=s(1102),x=s(4583),h=s(5082);function u(){let{shop:e}=(0,x.tN)(),[t,s]=(0,a.useState)("week"),[n,u]=(0,a.useState)(""),[p,m]=(0,a.useState)(""),[j,v]=(0,a.useState)({data:[],totals:{}}),[g,y]=(0,a.useState)([]),[f,N]=(0,a.useState)(!0),b=()=>{let e=new Date,s=e.toISOString().split("T")[0],r=s;if("week"===t){let t=new Date(e);t.setDate(t.getDate()-6),r=t.toISOString().split("T")[0]}else if("month"===t){let t=new Date(e);t.setDate(t.getDate()-29),r=t.toISOString().split("T")[0]}u(r),m(s)};(0,a.useEffect)(()=>{b()},[t]),(0,a.useEffect)(()=>{n&&p&&(async()=>{N(!0);try{let[e,t]=await Promise.all([o.vD.getRevenue({startDate:n,endDate:p}),o.vD.getTopProducts(10)]);v(e.data),y(t.data)}catch(e){console.error("Failed to fetch reports:",e)}finally{N(!1)}})()},[n,p]);let w=Math.max(...j.data?.map(e=>e.revenue)||[1],1);return(0,r.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"B\xe1o c\xe1o doanh thu"}),(0,r.jsxs)("button",{className:"btn btn-primary",onClick:()=>{if(!j.data||0===j.data.length){h.default.error("Kh\xf4ng c\xf3 dữ liệu để xuất");return}let t="\uFEFF";t+=`B\xc1O C\xc1O DOANH THU - ${e?.name||"QALY BAHA"}
Từ ng\xe0y: ${n} - Đến ng\xe0y: ${p}

TỔNG KẾT
Tổng doanh thu,${j.totals?.totalRevenue||0}
Số đơn ho\xe0n th\xe0nh,${j.totals?.totalOrders||0}
Gi\xe1 trị TB/đơn,${j.totals?.avgOrderValue||0}

CHI TIẾT THEO NG\xc0Y
Ng\xe0y,Số đơn,Doanh thu
`,[...j.data||[]].reverse().forEach(e=>{t+=`${e._id},${e.orders},${e.revenue}
`}),g.length>0&&(t+=`
SẢN PHẨM B\xc1N CHẠY
STT,Sản phẩm,Số lượng b\xe1n,Doanh thu
`,g.forEach((e,s)=>{t+=`${s+1},"${e.productName}",${e.totalQuantity},${e.totalRevenue}
`}));let s=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=`baocao_${n}_${p}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),h.default.success("Đ\xe3 xuất b\xe1o c\xe1o Excel")},disabled:f,children:[r.jsx(l,{className:"w-4 h-4"})," Xuất Excel"]})]}),r.jsx("div",{className:"card p-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[r.jsx("div",{className:"flex gap-2",children:["today","week","month"].map(e=>r.jsx("button",{className:`btn ${t===e?"btn-primary":"btn-secondary"}`,onClick:()=>s(e),children:"today"===e?"H\xf4m nay":"week"===e?"7 ng\xe0y":"30 ng\xe0y"},e))}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(i,{className:"w-5 h-5 text-dark-500"}),r.jsx("input",{type:"date",className:"input w-auto",value:n,onChange:e=>u(e.target.value)}),r.jsx("span",{className:"text-dark-500",children:"-"}),r.jsx("input",{type:"date",className:"input w-auto",value:p,onChange:e=>m(e.target.value)})]})]})}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-3 gap-4",children:[r.jsx("div",{className:"stats-card",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center",children:r.jsx(d.Z,{className:"w-6 h-6 text-green-400"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-dark-400 text-sm",children:"Tổng doanh thu"}),r.jsx("p",{className:"text-2xl font-bold",children:(0,x.xG)(j.totals?.totalRevenue||0)})]})]})}),r.jsx("div",{className:"stats-card",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-primary-500/20 rounded-xl flex items-center justify-center",children:r.jsx(c.Z,{className:"w-6 h-6 text-primary-400"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-dark-400 text-sm",children:"Đơn ho\xe0n th\xe0nh"}),r.jsx("p",{className:"text-2xl font-bold",children:j.totals?.totalOrders||0})]})]})}),r.jsx("div",{className:"stats-card",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center",children:r.jsx(d.Z,{className:"w-6 h-6 text-purple-400"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-dark-400 text-sm",children:"Gi\xe1 trị TB/đơn"}),r.jsx("p",{className:"text-2xl font-bold",children:(0,x.xG)(j.totals?.avgOrderValue||0)})]})]})})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"card",children:[r.jsx("div",{className:"p-4 border-b border-dark-800",children:r.jsx("h2",{className:"font-semibold",children:"Biểu đồ doanh thu"})}),r.jsx("div",{className:"p-4",children:f?r.jsx("div",{className:"h-64 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full"})}):j.data?.length===0?r.jsx("div",{className:"h-64 flex items-center justify-center text-dark-500",children:"Chưa c\xf3 dữ liệu"}):r.jsx("div",{className:"flex items-end justify-between h-64 gap-1 pt-6",children:j.data?.map((e,t)=>{let s=e.revenue/w*180;return r.jsxs("div",{className:"flex-1 flex flex-col items-center min-w-0",children:[r.jsxs("div",{className:"relative w-full max-w-[40px] mx-auto",children:[e.revenue>0&&r.jsxs("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 text-xs text-dark-400 whitespace-nowrap",children:[(e.revenue/1e6).toFixed(1),"M"]}),r.jsx("div",{className:"w-full bg-gradient-to-t from-primary-600 to-primary-400 rounded-t",style:{height:`${Math.max(s,4)}px`},title:`${e._id}: ${x.xG(e.revenue)}`})]}),r.jsx("div",{className:"text-xs text-dark-500 mt-2 truncate w-full text-center",children:e._id?.split("-").slice(1).join("/")})]},t)})})})]}),(0,r.jsxs)("div",{className:"card",children:[r.jsx("div",{className:"p-4 border-b border-dark-800",children:r.jsx("h2",{className:"font-semibold",children:"Sản phẩm b\xe1n chạy"})}),r.jsx("div",{className:"p-4 space-y-4",children:f?r.jsx("div",{className:"h-64 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full"})}):0===g.length?r.jsx("div",{className:"h-64 flex items-center justify-center text-dark-500",children:"Chưa c\xf3 dữ liệu"}):g.map((e,t)=>{let s=g[0]?.totalQuantity||1,a=e.totalQuantity/s*100;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`badge ${t<3?"badge-primary":"badge-gray"}`,children:t+1}),r.jsx("span",{className:"text-sm truncate",children:e.productName})]}),(0,r.jsxs)("span",{className:"text-sm text-dark-400",children:[e.totalQuantity," đ\xe3 b\xe1n"]})]}),r.jsx("div",{className:"h-2 bg-dark-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-primary-600 to-primary-400 rounded-full transition-all",style:{width:`${a}%`}})}),(0,r.jsxs)("p",{className:"text-xs text-dark-500 mt-1",children:["Doanh thu: ",(0,x.xG)(e.totalRevenue)]})]},e._id)})})]})]}),(0,r.jsxs)("div",{className:"card",children:[r.jsx("div",{className:"p-4 border-b border-dark-800",children:r.jsx("h2",{className:"font-semibold",children:"Chi tiết theo ng\xe0y"})}),r.jsx("div",{className:"table-container border-0 rounded-none",children:f?r.jsx("div",{className:"p-8 text-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"})}):(0,r.jsxs)("table",{className:"table",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Ng\xe0y"}),r.jsx("th",{className:"text-center",children:"Đơn ho\xe0n th\xe0nh"}),r.jsx("th",{className:"text-right",children:"Doanh thu"})]})}),r.jsx("tbody",{children:[...j.data||[]].reverse().map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"font-medium",children:e._id}),r.jsx("td",{className:"text-center",children:r.jsx("span",{className:`badge ${e.orders>0?"badge-primary":"badge-gray"}`,children:e.orders})}),r.jsx("td",{className:"text-right font-medium text-green-400",children:(0,x.xG)(e.revenue)})]},e._id))})]})})]})]})}},620:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(9858).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},7080:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});let r=(0,s(1481).createProxy)(String.raw`D:\APP\Test app QLBH w GG\frontend\src\app\dashboard\reports\page.tsx`),{__esModule:a,$$typeof:n}=r,l=r.default}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[100,766,59,712,5],()=>s(1617));module.exports=r})();