(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{7881:function(e,t,s){Promise.resolve().then(s.bind(s,3548))},3548:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var n=s(7821),a=s(8078),r=s(7684),l=s(3910),c=s(4505),i=s(4944),o=s(9574),d=s(189),u=s(229),h=s(7485);let m={owner:"Chủ shop",staff:"Nh\xe2n vi\xean b\xe1n h\xe0ng",accountant:"Kế to\xe1n"},p={owner:"primary",staff:"success",accountant:"warning"};function g(){var e,t;let{user:s}=(0,u.tN)(),[g,x]=(0,a.useState)([]),[v,f]=(0,a.useState)(!0),[b,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),[y,w]=(0,a.useState)(null),[C,S]=(0,a.useState)({name:"",email:"",role:"staff",password:""}),[A,I]=(0,a.useState)(""),Z=async()=>{try{let{data:e}=await d.Z9.getAll();x(e)}catch(t){var e;(null===(e=t.message)||void 0===e?void 0:e.includes("quyền"))&&h.default.error("Chỉ chủ shop mới c\xf3 thể quản l\xfd nh\xe2n vi\xean")}finally{f(!1)}};(0,a.useEffect)(()=>{Z()},[]);let L=e=>{e?(w(e),S({name:e.name,email:e.email,role:e.role,password:""})):(w(null),S({name:"",email:"",role:"staff",password:""})),j(!0)},E=async e=>{e.preventDefault();try{y?(await d.Z9.update(y._id,C),h.default.success("Đ\xe3 cập nhật nh\xe2n vi\xean")):(await d.Z9.create(C),h.default.success("Đ\xe3 th\xeam nh\xe2n vi\xean mới")),j(!1),Z()}catch(e){h.default.error(e.message||"C\xf3 lỗi xảy ra")}},P=async e=>{if(confirm('Bạn c\xf3 chắc muốn x\xf3a "'.concat(e.name,'"?')))try{await d.Z9.delete(e._id),h.default.success("Đ\xe3 x\xf3a nh\xe2n vi\xean"),Z()}catch(e){h.default.error(e.message||"C\xf3 lỗi xảy ra")}},_=async()=>{if(!A||A.length<6){h.default.error("Mật khẩu phải c\xf3 \xedt nhất 6 k\xfd tự");return}try{await d.Z9.resetPassword(N._id,A),h.default.success("Đ\xe3 đặt lại mật khẩu"),k(null),I("")}catch(e){h.default.error(e.message||"C\xf3 lỗi xảy ra")}};return(null==s?void 0:s.role)!=="owner"?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,n.jsx)(r.Z,{className:"w-16 h-16 text-dark-600 mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Kh\xf4ng c\xf3 quyền truy cập"}),(0,n.jsx)("p",{className:"text-dark-400",children:"Chỉ chủ shop mới c\xf3 thể quản l\xfd nh\xe2n vi\xean"})]}):(0,n.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Quản l\xfd nh\xe2n vi\xean"}),(0,n.jsx)("p",{className:"text-dark-400 text-sm mt-1",children:"Th\xeam v\xe0 ph\xe2n quyền nh\xe2n vi\xean cho cửa h\xe0ng"})]}),(0,n.jsxs)("button",{className:"btn btn-primary",onClick:()=>L(),children:[(0,n.jsx)(l.Z,{className:"w-5 h-5"})," Th\xeam nh\xe2n vi\xean"]})]}),(0,n.jsx)("div",{className:"card p-4 border-primary-500/50",children:(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-primary-500/20 rounded-full flex items-center justify-center text-primary-400 text-xl font-bold",children:null==s?void 0:null===(t=s.name)||void 0===t?void 0:null===(e=t.charAt(0))||void 0===e?void 0:e.toUpperCase()}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("p",{className:"font-semibold",children:[null==s?void 0:s.name," ",(0,n.jsx)("span",{className:"text-primary-400",children:"(Bạn)"})]}),(0,n.jsx)("p",{className:"text-sm text-dark-400",children:null==s?void 0:s.email})]}),(0,n.jsx)("span",{className:"badge badge-primary",children:m.owner})]})}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("div",{className:"p-4 border-b border-dark-800",children:(0,n.jsx)("h2",{className:"font-semibold",children:"Danh s\xe1ch nh\xe2n vi\xean"})}),v?(0,n.jsx)("div",{className:"p-8 text-center",children:(0,n.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===g.length?(0,n.jsxs)("div",{className:"p-8 text-center text-dark-500",children:[(0,n.jsx)(r.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,n.jsx)("p",{children:"Chưa c\xf3 nh\xe2n vi\xean n\xe0o"}),(0,n.jsxs)("button",{className:"btn btn-primary mt-4",onClick:()=>L(),children:[(0,n.jsx)(l.Z,{className:"w-4 h-4"})," Th\xeam nh\xe2n vi\xean đầu ti\xean"]})]}):(0,n.jsx)("div",{className:"divide-y divide-dark-800",children:g.map(e=>{var t,s;return(0,n.jsxs)("div",{className:"p-4 flex items-center gap-4 hover:bg-dark-800/50",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-dark-700 rounded-full flex items-center justify-center text-dark-300 font-medium",children:null===(s=e.name)||void 0===s?void 0:null===(t=s.charAt(0))||void 0===t?void 0:t.toUpperCase()}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"font-medium",children:e.name}),(0,n.jsx)("p",{className:"text-sm text-dark-400 truncate",children:e.email})]}),(0,n.jsx)("span",{className:"badge badge-".concat(p[e.role]),children:m[e.role]}),(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)("button",{className:"btn btn-ghost p-2",onClick:()=>k(e),title:"Đặt lại mật khẩu",children:(0,n.jsx)(c.Z,{className:"w-4 h-4"})}),(0,n.jsx)("button",{className:"btn btn-ghost p-2",onClick:()=>L(e),children:(0,n.jsx)(i.Z,{className:"w-4 h-4"})}),(0,n.jsx)("button",{className:"btn btn-ghost p-2 text-red-400",onClick:()=>P(e),children:(0,n.jsx)(o.Z,{className:"w-4 h-4"})})]})]},e._id)})})]}),(0,n.jsxs)("div",{className:"card p-4",children:[(0,n.jsx)("h3",{className:"font-semibold mb-3",children:"Ph\xe2n quyền"}),(0,n.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{className:"p-3 bg-dark-800 rounded-lg",children:[(0,n.jsx)("span",{className:"badge badge-success mb-2",children:"Nh\xe2n vi\xean b\xe1n h\xe0ng"}),(0,n.jsxs)("ul",{className:"text-dark-400 space-y-1",children:[(0,n.jsx)("li",{children:"• Tạo v\xe0 xử l\xfd đơn h\xe0ng"}),(0,n.jsx)("li",{children:"• Xem sản phẩm v\xe0 kh\xe1ch h\xe0ng"}),(0,n.jsx)("li",{children:"• Kh\xf4ng xem b\xe1o c\xe1o t\xe0i ch\xednh"})]})]}),(0,n.jsxs)("div",{className:"p-3 bg-dark-800 rounded-lg",children:[(0,n.jsx)("span",{className:"badge badge-warning mb-2",children:"Kế to\xe1n"}),(0,n.jsxs)("ul",{className:"text-dark-400 space-y-1",children:[(0,n.jsx)("li",{children:"• Xem b\xe1o c\xe1o t\xe0i ch\xednh"}),(0,n.jsx)("li",{children:"• Quản l\xfd xuất nhập kho"}),(0,n.jsx)("li",{children:"• Kh\xf4ng tạo đơn h\xe0ng"})]})]})]})]}),b&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-md",children:[(0,n.jsx)("div",{className:"p-4 border-b border-dark-800",children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:y?"Sửa nh\xe2n vi\xean":"Th\xeam nh\xe2n vi\xean mới"})}),(0,n.jsxs)("form",{onSubmit:E,className:"p-4 space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Họ t\xean *"}),(0,n.jsx)("input",{className:"input",required:!0,value:C.name,onChange:e=>S({...C,name:e.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Email *"}),(0,n.jsx)("input",{type:"email",className:"input",required:!0,value:C.email,onChange:e=>S({...C,email:e.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Vai tr\xf2 *"}),(0,n.jsxs)("select",{className:"input",value:C.role,onChange:e=>S({...C,role:e.target.value}),children:[(0,n.jsx)("option",{value:"staff",children:"Nh\xe2n vi\xean b\xe1n h\xe0ng"}),(0,n.jsx)("option",{value:"accountant",children:"Kế to\xe1n"})]})]}),!y&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:'Mật khẩu (để trống = "changeme123")'}),(0,n.jsx)("input",{type:"password",className:"input",placeholder:"Mật khẩu ban đầu",value:C.password,onChange:e=>S({...C,password:e.target.value})})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary flex-1",onClick:()=>j(!1),children:"Hủy"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary flex-1",children:y?"Cập nhật":"Th\xeam"})]})]})]})}),N&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-sm",children:[(0,n.jsx)("div",{className:"p-4 border-b border-dark-800",children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Đặt lại mật khẩu"})}),(0,n.jsxs)("div",{className:"p-4 space-y-4",children:[(0,n.jsxs)("p",{className:"text-dark-400",children:["Đặt mật khẩu mới cho ",(0,n.jsx)("strong",{children:N.name})]}),(0,n.jsx)("input",{type:"password",className:"input",placeholder:"Mật khẩu mới (tối thiểu 6 k\xfd tự)",value:A,onChange:e=>I(e.target.value)}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{className:"btn btn-secondary flex-1",onClick:()=>{k(null),I("")},children:"Hủy"}),(0,n.jsx)("button",{className:"btn btn-primary flex-1",onClick:_,children:"X\xe1c nhận"})]})]})]})})]})}},189:function(e,t,s){"use strict";s.d(t,{F3:function(){return r},IK:function(){return u},Z9:function(){return o},ZE:function(){return d},fU:function(){return l},g3:function(){return c},kv:function(){return a},v2:function(){return h},vD:function(){return i}});let n=s(1892).Z.create({baseURL:"http://localhost:8080/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),n.interceptors.response.use(e=>e,e=>{var t,s,n,a,r,l;let c=(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Đ\xe3 xảy ra lỗi";return(null===(a=e.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.code)==="LICENSE_EXPIRED"&&(window.location.href="/license-expired"),(null===(r=e.response)||void 0===r?void 0:r.status)===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject({message:c,...null===(l=e.response)||void 0===l?void 0:l.data})});let a={register:e=>n.post("/auth/register",e),login:e=>n.post("/auth/login",e),getMe:()=>n.get("/auth/me"),verifyEmail:e=>n.get("/auth/verify-email/".concat(e)),forgotPassword:e=>n.post("/auth/forgot-password",{email:e}),resetPassword:(e,t)=>n.post("/auth/reset-password/".concat(e),{password:t}),updateShop:e=>n.put("/auth/shop",e),changePassword:(e,t)=>n.put("/auth/change-password",{currentPassword:e,newPassword:t})},r={getAll:e=>n.get("/products",{params:e}),getById:e=>n.get("/products/".concat(e)),create:e=>n.post("/products",e),update:(e,t)=>n.put("/products/".concat(e),t),delete:e=>n.delete("/products/".concat(e)),getCategories:()=>n.get("/products/categories"),getLowStock:()=>n.get("/products/low-stock"),updateStock:(e,t,s)=>n.patch("/products/".concat(e,"/stock"),{adjustment:t,reason:s})},l={getAll:e=>n.get("/customers",{params:e}),getById:e=>n.get("/customers/".concat(e)),create:e=>n.post("/customers",e),update:(e,t)=>n.put("/customers/".concat(e),t),delete:e=>n.delete("/customers/".concat(e)),getOrders:e=>n.get("/customers/".concat(e,"/orders"))},c={getAll:e=>n.get("/orders",{params:e}),getById:e=>n.get("/orders/".concat(e)),create:e=>n.post("/orders",e),updateStatus:(e,t,s)=>n.patch("/orders/".concat(e,"/status"),{status:t,note:s}),cancel:(e,t)=>n.post("/orders/".concat(e,"/cancel"),{reason:t}),getStats:()=>n.get("/orders/stats")},i={getStats:()=>n.get("/dashboard/stats"),getRevenue:e=>n.get("/dashboard/revenue",{params:e}),getTopProducts:e=>n.get("/dashboard/top-products",{params:{limit:e}}),getRecentOrders:e=>n.get("/dashboard/recent-orders",{params:{limit:e}})},o={getAll:()=>n.get("/staff"),create:e=>n.post("/staff",e),update:(e,t)=>n.put("/staff/".concat(e),t),delete:e=>n.delete("/staff/".concat(e)),resetPassword:(e,t)=>n.post("/staff/".concat(e,"/reset-password"),{newPassword:t})},d={getAll:e=>n.get("/suppliers",{params:e}),getById:e=>n.get("/suppliers/".concat(e)),create:e=>n.post("/suppliers",e),update:(e,t)=>n.put("/suppliers/".concat(e),t),delete:e=>n.delete("/suppliers/".concat(e))},u={getAll:()=>n.get("/integrations"),get:e=>n.get("/integrations/".concat(e)),connect:(e,t)=>n.post("/integrations/".concat(e,"/connect"),t),disconnect:e=>n.post("/integrations/".concat(e,"/disconnect")),updateSettings:(e,t)=>n.patch("/integrations/".concat(e,"/settings"),t),syncProducts:e=>n.post("/integrations/".concat(e,"/sync-products")),syncOrders:e=>n.post("/integrations/".concat(e,"/sync-orders"))},h={get:()=>n.get("/tier-settings"),update:e=>n.put("/tier-settings",{tiers:e})}},229:function(e,t,s){"use strict";s.d(t,{AQ:function(){return o},cL:function(){return i},p6:function(){return c},tN:function(){return r},xG:function(){return l}});var n=s(8433),a=s(189);let r=(0,n.Ue)((e,t)=>({user:null,shop:null,token:localStorage.getItem("token"),isLoading:!0,isAuthenticated:!1,login:async(t,s)=>{let{data:n}=await a.kv.login({email:t,password:s});localStorage.setItem("token",n.token),e({user:n.user,shop:n.shop,token:n.token,isAuthenticated:!0,isLoading:!1})},register:async t=>{let{data:s}=await a.kv.register(t);localStorage.setItem("token",s.token),e({user:s.user,shop:s.shop,token:s.token,isAuthenticated:!0,isLoading:!1})},logout:()=>{localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})},fetchUser:async()=>{let t=localStorage.getItem("token");if(!t){e({isLoading:!1,isAuthenticated:!1});return}try{let{data:s}=await a.kv.getMe();e({user:s.user,shop:s.shop,token:t,isAuthenticated:!0,isLoading:!1})}catch(t){localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})}},setAuth:(t,s,n)=>{localStorage.setItem("token",n),e({user:t,shop:s,token:n,isAuthenticated:!0,isLoading:!1})},setShop:t=>{e({shop:t})}})),l=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s={day:"2-digit",month:"2-digit",year:"numeric"};return t&&(s.hour="2-digit",s.minute="2-digit"),new Date(e).toLocaleDateString("vi-VN",s)},i={pending:"Chờ xử l\xfd",processing:"Đang xử l\xfd",shipping:"Đang giao",completed:"Ho\xe0n th\xe0nh",cancelled:"Đ\xe3 hủy"},o={pending:"warning",processing:"primary",shipping:"primary",completed:"success",cancelled:"danger"}}},function(e){e.O(0,[798,349,115,141,744],function(){return e(e.s=7881)}),_N_E=e.O()}]);