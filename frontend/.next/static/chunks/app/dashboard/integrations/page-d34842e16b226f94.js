(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[535],{6026:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7068).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3606:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7068).Z)("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]])},3317:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7068).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},773:function(e,t,s){Promise.resolve().then(s.bind(s,4645))},4645:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var n=s(7821),a=s(8078),c=s(7068);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,c.Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var o=s(3317);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,c.Z)("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),l=(0,c.Z)("Link2Off",[["path",{d:"M9 17H7A5 5 0 0 1 7 7",key:"10o201"}],["path",{d:"M15 7h2a5 5 0 0 1 4 8",key:"1d3206"}],["line",{x1:"8",x2:"12",y1:"12",y2:"12",key:"rvw6j4"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);var d=s(6026);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,c.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var h=s(3287),p=s(8806);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let g=(0,c.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var m=s(3606),x=s(189),f=s(229),k=s(7485);let v=[{id:"shopee",name:"Shopee",icon:r,color:"orange",description:"Đồng bộ sản phẩm v\xe0 đơn h\xe0ng từ Shopee"},{id:"lazada",name:"Lazada",icon:o.Z,color:"blue",description:"Đồng bộ sản phẩm v\xe0 đơn h\xe0ng từ Lazada"},{id:"facebook",name:"Facebook Shop",icon:i,color:"indigo",description:"Đồng bộ sản phẩm l\xean Facebook Shop"}];function y(){var e;let{user:t}=(0,f.tN)(),[s,c]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),[w,S]=(0,a.useState)({shopId:"",accessToken:""}),I=async()=>{try{let{data:e}=await x.IK.getAll();c(e)}catch(e){console.error("Failed to fetch integrations:",e)}finally{i(!1)}};(0,a.useEffect)(()=>{I()},[]);let A=e=>s.find(t=>t.platform===e),C=async e=>{try{await x.IK.connect(e,w),k.default.success("Đ\xe3 kết nối ".concat(e.charAt(0).toUpperCase()+e.slice(1))),N(null),S({shopId:"",accessToken:""}),I()}catch(e){k.default.error(e.message||"Kết nối thất bại")}},Z=async e=>{if(confirm("Bạn c\xf3 chắc muốn ngắt kết nối?"))try{await x.IK.disconnect(e),k.default.success("Đ\xe3 ngắt kết nối"),I()}catch(e){k.default.error(e.message||"C\xf3 lỗi xảy ra")}},L=async(e,t)=>{b("".concat(e,"-").concat(t));try{if("products"===t){let{data:t}=await x.IK.syncProducts(e);k.default.success(t.message)}else{let{data:t}=await x.IK.syncOrders(e);k.default.success(t.message)}I()}catch(e){k.default.error(e.message||"Đồng bộ thất bại")}finally{b(null)}};return(null==t?void 0:t.role)!=="owner"?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,n.jsx)(l,{className:"w-16 h-16 text-dark-600 mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Kh\xf4ng c\xf3 quyền truy cập"}),(0,n.jsx)("p",{className:"text-dark-400",children:"Chỉ chủ shop mới c\xf3 thể quản l\xfd kết nối"})]}):(0,n.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Kết nối s\xe0n TMĐT"}),(0,n.jsx)("p",{className:"text-dark-400 text-sm mt-1",children:"Kết nối v\xe0 đồng bộ dữ liệu với c\xe1c s\xe0n thương mại điện tử"})]}),r?(0,n.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,n.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full"})}):(0,n.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(e=>{var t;let s=A(e.id),a=(null==s?void 0:s.status)==="connected",c=e.icon;return(0,n.jsxs)("div",{className:"card overflow-hidden ".concat(a?"border-green-500/50":""),children:[(0,n.jsx)("div",{className:"p-4 bg-gradient-to-r from-".concat(e.color,"-500/20 to-").concat(e.color,"-600/10 border-b border-dark-800"),children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-500/20 rounded-xl flex items-center justify-center"),children:(0,n.jsx)(c,{className:"w-6 h-6 text-".concat(e.color,"-400")})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold",children:e.name}),(0,n.jsx)("span",{className:"text-xs ".concat(a?"text-green-400":"text-dark-500"),children:a?"● Đ\xe3 kết nối":"○ Chưa kết nối"})]})]}),a?(0,n.jsx)(d.Z,{className:"w-6 h-6 text-green-400"}):(0,n.jsx)(u,{className:"w-6 h-6 text-dark-600"})]})}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("p",{className:"text-sm text-dark-400 mb-4",children:e.description}),a&&(null==s?void 0:s.stats)&&(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,n.jsxs)("div",{className:"bg-dark-800 rounded-lg p-3 text-center",children:[(0,n.jsx)(h.Z,{className:"w-5 h-5 mx-auto text-primary-400 mb-1"}),(0,n.jsx)("p",{className:"text-lg font-bold",children:s.stats.totalProductsSynced}),(0,n.jsx)("p",{className:"text-xs text-dark-500",children:"SP đ\xe3 đồng bộ"})]}),(0,n.jsxs)("div",{className:"bg-dark-800 rounded-lg p-3 text-center",children:[(0,n.jsx)(o.Z,{className:"w-5 h-5 mx-auto text-green-400 mb-1"}),(0,n.jsx)("p",{className:"text-lg font-bold",children:s.stats.totalOrdersSynced}),(0,n.jsx)("p",{className:"text-xs text-dark-500",children:"ĐH đ\xe3 đồng bộ"})]})]}),a&&(null==s?void 0:null===(t=s.settings)||void 0===t?void 0:t.lastSyncAt)&&(0,n.jsxs)("p",{className:"text-xs text-dark-500 mb-4",children:["Đồng bộ lần cuối: ",(0,f.p6)(s.settings.lastSyncAt,!0)]}),a?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)("button",{className:"btn btn-secondary flex-1 text-sm",onClick:()=>L(e.id,"products"),disabled:null!==y,children:[y==="".concat(e.id,"-products")?(0,n.jsx)(p.Z,{className:"w-4 h-4 animate-spin"}):(0,n.jsx)(g,{className:"w-4 h-4"}),"Đồng bộ SP"]}),"facebook"!==e.id&&(0,n.jsxs)("button",{className:"btn btn-secondary flex-1 text-sm",onClick:()=>L(e.id,"orders"),disabled:null!==y,children:[y==="".concat(e.id,"-orders")?(0,n.jsx)(p.Z,{className:"w-4 h-4 animate-spin"}):(0,n.jsx)(g,{className:"w-4 h-4"}),"Đồng bộ ĐH"]})]}),(0,n.jsxs)("button",{className:"btn btn-danger w-full text-sm",onClick:()=>Z(e.id),children:[(0,n.jsx)(l,{className:"w-4 h-4"})," Ngắt kết nối"]})]}):(0,n.jsxs)("button",{className:"btn btn-primary w-full",onClick:()=>N(e.id),children:[(0,n.jsx)(m.Z,{className:"w-4 h-4"})," Kết nối ngay"]})]})]},e.id)})}),(0,n.jsxs)("div",{className:"card p-4",children:[(0,n.jsx)("h3",{className:"font-semibold mb-3",children:"Hướng dẫn kết nối"}),(0,n.jsxs)("div",{className:"text-sm text-dark-400 space-y-2",children:[(0,n.jsx)("p",{children:"1. Đăng k\xfd t\xe0i khoản b\xe1n h\xe0ng tr\xean s\xe0n TMĐT (Shopee, Lazada, Facebook)"}),(0,n.jsx)("p",{children:"2. Đăng k\xfd l\xe0m đối t\xe1c API của s\xe0n để lấy th\xf4ng tin kết nối"}),(0,n.jsx)("p",{children:"3. Nhập Shop ID v\xe0 Access Token v\xe0o form kết nối"}),(0,n.jsx)("p",{children:'4. Sau khi kết nối th\xe0nh c\xf4ng, sử dụng n\xfat "Đồng bộ" để đồng bộ dữ liệu'})]})]}),j&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-md",children:[(0,n.jsx)("div",{className:"p-4 border-b border-dark-800",children:(0,n.jsxs)("h2",{className:"text-lg font-semibold",children:["Kết nối ",null===(e=v.find(e=>e.id===j))||void 0===e?void 0:e.name]})}),(0,n.jsxs)("div",{className:"p-4 space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Shop ID / Page ID *"}),(0,n.jsx)("input",{className:"input",placeholder:"Nhập ID shop/page từ s\xe0n",value:w.shopId,onChange:e=>S({...w,shopId:e.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Access Token (t\xf9y chọn)"}),(0,n.jsx)("input",{className:"input",placeholder:"Để trống để d\xf9ng token demo",value:w.accessToken,onChange:e=>S({...w,accessToken:e.target.value})}),(0,n.jsx)("p",{className:"text-xs text-dark-500 mt-1",children:"Để trống nếu chỉ muốn test demo"})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)("button",{className:"btn btn-secondary flex-1",onClick:()=>N(null),children:"Hủy"}),(0,n.jsx)("button",{className:"btn btn-primary flex-1",onClick:()=>C(j),children:"Kết nối"})]})]})]})})]})}},189:function(e,t,s){"use strict";s.d(t,{F3:function(){return c},IK:function(){return u},Z9:function(){return l},ZE:function(){return d},fU:function(){return r},g3:function(){return o},kv:function(){return a},v2:function(){return h},vD:function(){return i}});let n=s(1892).Z.create({baseURL:"http://localhost:8080/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),n.interceptors.response.use(e=>e,e=>{var t,s,n,a,c,r;let o=(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Đ\xe3 xảy ra lỗi";return(null===(a=e.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.code)==="LICENSE_EXPIRED"&&(window.location.href="/license-expired"),(null===(c=e.response)||void 0===c?void 0:c.status)===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject({message:o,...null===(r=e.response)||void 0===r?void 0:r.data})});let a={register:e=>n.post("/auth/register",e),login:e=>n.post("/auth/login",e),getMe:()=>n.get("/auth/me"),verifyEmail:e=>n.get("/auth/verify-email/".concat(e)),forgotPassword:e=>n.post("/auth/forgot-password",{email:e}),resetPassword:(e,t)=>n.post("/auth/reset-password/".concat(e),{password:t}),updateShop:e=>n.put("/auth/shop",e),changePassword:(e,t)=>n.put("/auth/change-password",{currentPassword:e,newPassword:t})},c={getAll:e=>n.get("/products",{params:e}),getById:e=>n.get("/products/".concat(e)),create:e=>n.post("/products",e),update:(e,t)=>n.put("/products/".concat(e),t),delete:e=>n.delete("/products/".concat(e)),getCategories:()=>n.get("/products/categories"),getLowStock:()=>n.get("/products/low-stock"),updateStock:(e,t,s)=>n.patch("/products/".concat(e,"/stock"),{adjustment:t,reason:s})},r={getAll:e=>n.get("/customers",{params:e}),getById:e=>n.get("/customers/".concat(e)),create:e=>n.post("/customers",e),update:(e,t)=>n.put("/customers/".concat(e),t),delete:e=>n.delete("/customers/".concat(e)),getOrders:e=>n.get("/customers/".concat(e,"/orders"))},o={getAll:e=>n.get("/orders",{params:e}),getById:e=>n.get("/orders/".concat(e)),create:e=>n.post("/orders",e),updateStatus:(e,t,s)=>n.patch("/orders/".concat(e,"/status"),{status:t,note:s}),cancel:(e,t)=>n.post("/orders/".concat(e,"/cancel"),{reason:t}),getStats:()=>n.get("/orders/stats")},i={getStats:()=>n.get("/dashboard/stats"),getRevenue:e=>n.get("/dashboard/revenue",{params:e}),getTopProducts:e=>n.get("/dashboard/top-products",{params:{limit:e}}),getRecentOrders:e=>n.get("/dashboard/recent-orders",{params:{limit:e}})},l={getAll:()=>n.get("/staff"),create:e=>n.post("/staff",e),update:(e,t)=>n.put("/staff/".concat(e),t),delete:e=>n.delete("/staff/".concat(e)),resetPassword:(e,t)=>n.post("/staff/".concat(e,"/reset-password"),{newPassword:t})},d={getAll:e=>n.get("/suppliers",{params:e}),getById:e=>n.get("/suppliers/".concat(e)),create:e=>n.post("/suppliers",e),update:(e,t)=>n.put("/suppliers/".concat(e),t),delete:e=>n.delete("/suppliers/".concat(e))},u={getAll:()=>n.get("/integrations"),get:e=>n.get("/integrations/".concat(e)),connect:(e,t)=>n.post("/integrations/".concat(e,"/connect"),t),disconnect:e=>n.post("/integrations/".concat(e,"/disconnect")),updateSettings:(e,t)=>n.patch("/integrations/".concat(e,"/settings"),t),syncProducts:e=>n.post("/integrations/".concat(e,"/sync-products")),syncOrders:e=>n.post("/integrations/".concat(e,"/sync-orders"))},h={get:()=>n.get("/tier-settings"),update:e=>n.put("/tier-settings",{tiers:e})}},229:function(e,t,s){"use strict";s.d(t,{AQ:function(){return l},cL:function(){return i},p6:function(){return o},tN:function(){return c},xG:function(){return r}});var n=s(8433),a=s(189);let c=(0,n.Ue)((e,t)=>({user:null,shop:null,token:localStorage.getItem("token"),isLoading:!0,isAuthenticated:!1,login:async(t,s)=>{let{data:n}=await a.kv.login({email:t,password:s});localStorage.setItem("token",n.token),e({user:n.user,shop:n.shop,token:n.token,isAuthenticated:!0,isLoading:!1})},register:async t=>{let{data:s}=await a.kv.register(t);localStorage.setItem("token",s.token),e({user:s.user,shop:s.shop,token:s.token,isAuthenticated:!0,isLoading:!1})},logout:()=>{localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})},fetchUser:async()=>{let t=localStorage.getItem("token");if(!t){e({isLoading:!1,isAuthenticated:!1});return}try{let{data:s}=await a.kv.getMe();e({user:s.user,shop:s.shop,token:t,isAuthenticated:!0,isLoading:!1})}catch(t){localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})}},setAuth:(t,s,n)=>{localStorage.setItem("token",n),e({user:t,shop:s,token:n,isAuthenticated:!0,isLoading:!1})},setShop:t=>{e({shop:t})}})),r=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s={day:"2-digit",month:"2-digit",year:"numeric"};return t&&(s.hour="2-digit",s.minute="2-digit"),new Date(e).toLocaleDateString("vi-VN",s)},i={pending:"Chờ xử l\xfd",processing:"Đang xử l\xfd",shipping:"Đang giao",completed:"Ho\xe0n th\xe0nh",cancelled:"Đ\xe3 hủy"},l={pending:"warning",processing:"primary",shipping:"primary",completed:"success",cancelled:"danger"}}},function(e){e.O(0,[798,925,115,141,744],function(){return e(e.s=773)}),_N_E=e.O()}]);