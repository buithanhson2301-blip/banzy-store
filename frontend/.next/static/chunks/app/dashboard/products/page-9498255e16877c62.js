(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{4414:function(e,t,s){Promise.resolve().then(s.bind(s,7057))},7057:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var n=s(7821),a=s(8078),r=s(3910),c=s(2183),o=s(8347),i=s(4944),l=s(9574),d=s(189),u=s(229),p=s(7485);function h(){let[e,t]=(0,a.useState)([]),[s,h]=(0,a.useState)(!0),[g,m]=(0,a.useState)(""),[x,f]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[b,j]=(0,a.useState)({name:"",code:"",category:"",price:"",quantity:"",minStock:"5",description:""}),N=async()=>{try{let{data:e}=await d.F3.getAll({search:g,limit:100});t(e.products)}catch(e){console.error("Failed to fetch products:",e)}finally{h(!1)}};(0,a.useEffect)(()=>{N()},[]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{N()},300);return()=>clearTimeout(e)},[g]);let k=e=>{e?(y(e),j({name:e.name,code:e.code||"",category:e.category||"",price:e.price.toString(),quantity:e.quantity.toString(),minStock:e.minStock.toString(),description:""})):(y(null),j({name:"",code:"",category:"",price:"",quantity:"",minStock:"5",description:""})),f(!0)},S=async e=>{e.preventDefault();try{let e={...b,price:parseFloat(b.price),quantity:parseInt(b.quantity),minStock:parseInt(b.minStock)};v?(await d.F3.update(v._id,e),p.default.success("Đ\xe3 cập nhật sản phẩm")):(await d.F3.create(e),p.default.success("Đ\xe3 th\xeam sản phẩm mới")),f(!1),N()}catch(e){p.default.error(e.message||"C\xf3 lỗi xảy ra")}},w=async e=>{if(confirm('Bạn c\xf3 chắc muốn x\xf3a "'.concat(e.name,'"?')))try{await d.F3.delete(e._id),p.default.success("Đ\xe3 x\xf3a sản phẩm"),N()}catch(e){p.default.error(e.message||"C\xf3 lỗi xảy ra")}};return(0,n.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Sản phẩm"}),(0,n.jsxs)("button",{className:"btn btn-primary",onClick:()=>k(),children:[(0,n.jsx)(r.Z,{className:"w-5 h-5"})," Th\xeam sản phẩm"]})]}),(0,n.jsxs)("div",{className:"relative max-w-md",children:[(0,n.jsx)(c.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-dark-500"}),(0,n.jsx)("input",{type:"text",className:"input pl-10",placeholder:"T\xecm kiếm sản phẩm...",value:g,onChange:e=>m(e.target.value)})]}),(0,n.jsx)("div",{className:"table-container",children:s?(0,n.jsx)("div",{className:"p-8 text-center",children:(0,n.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===e.length?(0,n.jsx)("div",{className:"p-8 text-center text-dark-500",children:g?"Kh\xf4ng t\xecm thấy sản phẩm":"Chưa c\xf3 sản phẩm n\xe0o"}):(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"M\xe3 SP"}),(0,n.jsx)("th",{children:"T\xean sản phẩm"}),(0,n.jsx)("th",{children:"Danh mục"}),(0,n.jsx)("th",{children:"Gi\xe1 b\xe1n"}),(0,n.jsx)("th",{children:"Tồn kho"}),(0,n.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,n.jsx)("tbody",{children:e.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"font-medium",children:e.code||"-"}),(0,n.jsx)("td",{children:e.name}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"badge badge-gray",children:e.category||"Kh\xe1c"})}),(0,n.jsx)("td",{children:(0,u.xG)(e.price)}),(0,n.jsx)("td",{children:(0,n.jsxs)("span",{className:"badge ".concat(e.quantity<=e.minStock?"badge-danger":"badge-success"),children:[e.quantity<=e.minStock&&(0,n.jsx)(o.Z,{className:"w-3 h-3 mr-1"}),e.quantity]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"btn btn-ghost p-2",onClick:()=>k(e),children:(0,n.jsx)(i.Z,{className:"w-4 h-4"})}),(0,n.jsx)("button",{className:"btn btn-ghost p-2 text-red-400",onClick:()=>w(e),children:(0,n.jsx)(l.Z,{className:"w-4 h-4"})})]})})]},e._id))})]})}),x&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,n.jsx)("div",{className:"p-4 border-b border-dark-800",children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:v?"Sửa sản phẩm":"Th\xeam sản phẩm mới"})}),(0,n.jsxs)("form",{onSubmit:S,className:"p-4 space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"T\xean sản phẩm *"}),(0,n.jsx)("input",{className:"input",required:!0,value:b.name,onChange:e=>j({...b,name:e.target.value})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"M\xe3 sản phẩm"}),(0,n.jsx)("input",{className:"input",value:b.code,onChange:e=>j({...b,code:e.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Danh mục"}),(0,n.jsx)("input",{className:"input",value:b.category,onChange:e=>j({...b,category:e.target.value})})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Gi\xe1 b\xe1n *"}),(0,n.jsx)("input",{type:"text",className:"input",required:!0,placeholder:"150.000",value:b.price?Number(b.price.replace(/\./g,"")).toLocaleString("vi-VN"):"",onChange:e=>{let t=e.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");j({...b,price:t})}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Số lượng *"}),(0,n.jsx)("input",{type:"number",className:"input",required:!0,min:"0",value:b.quantity,onChange:e=>j({...b,quantity:e.target.value})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Ngưỡng cảnh b\xe1o"}),(0,n.jsx)("input",{type:"number",className:"input",min:"0",value:b.minStock,onChange:e=>j({...b,minStock:e.target.value})})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary flex-1",onClick:()=>f(!1),children:"Hủy"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary flex-1",children:v?"Cập nhật":"Th\xeam mới"})]})]})]})})]})}},189:function(e,t,s){"use strict";s.d(t,{F3:function(){return r},IK:function(){return u},Z9:function(){return l},ZE:function(){return d},fU:function(){return c},g3:function(){return o},kv:function(){return a},v2:function(){return p},vD:function(){return i}});let n=s(1892).Z.create({baseURL:"http://localhost:8080/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),n.interceptors.response.use(e=>e,e=>{var t,s,n,a,r,c;let o=(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Đ\xe3 xảy ra lỗi";return(null===(a=e.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.code)==="LICENSE_EXPIRED"&&(window.location.href="/license-expired"),(null===(r=e.response)||void 0===r?void 0:r.status)===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject({message:o,...null===(c=e.response)||void 0===c?void 0:c.data})});let a={register:e=>n.post("/auth/register",e),login:e=>n.post("/auth/login",e),getMe:()=>n.get("/auth/me"),verifyEmail:e=>n.get("/auth/verify-email/".concat(e)),forgotPassword:e=>n.post("/auth/forgot-password",{email:e}),resetPassword:(e,t)=>n.post("/auth/reset-password/".concat(e),{password:t}),updateShop:e=>n.put("/auth/shop",e),changePassword:(e,t)=>n.put("/auth/change-password",{currentPassword:e,newPassword:t})},r={getAll:e=>n.get("/products",{params:e}),getById:e=>n.get("/products/".concat(e)),create:e=>n.post("/products",e),update:(e,t)=>n.put("/products/".concat(e),t),delete:e=>n.delete("/products/".concat(e)),getCategories:()=>n.get("/products/categories"),getLowStock:()=>n.get("/products/low-stock"),updateStock:(e,t,s)=>n.patch("/products/".concat(e,"/stock"),{adjustment:t,reason:s})},c={getAll:e=>n.get("/customers",{params:e}),getById:e=>n.get("/customers/".concat(e)),create:e=>n.post("/customers",e),update:(e,t)=>n.put("/customers/".concat(e),t),delete:e=>n.delete("/customers/".concat(e)),getOrders:e=>n.get("/customers/".concat(e,"/orders"))},o={getAll:e=>n.get("/orders",{params:e}),getById:e=>n.get("/orders/".concat(e)),create:e=>n.post("/orders",e),updateStatus:(e,t,s)=>n.patch("/orders/".concat(e,"/status"),{status:t,note:s}),cancel:(e,t)=>n.post("/orders/".concat(e,"/cancel"),{reason:t}),getStats:()=>n.get("/orders/stats")},i={getStats:()=>n.get("/dashboard/stats"),getRevenue:e=>n.get("/dashboard/revenue",{params:e}),getTopProducts:e=>n.get("/dashboard/top-products",{params:{limit:e}}),getRecentOrders:e=>n.get("/dashboard/recent-orders",{params:{limit:e}})},l={getAll:()=>n.get("/staff"),create:e=>n.post("/staff",e),update:(e,t)=>n.put("/staff/".concat(e),t),delete:e=>n.delete("/staff/".concat(e)),resetPassword:(e,t)=>n.post("/staff/".concat(e,"/reset-password"),{newPassword:t})},d={getAll:e=>n.get("/suppliers",{params:e}),getById:e=>n.get("/suppliers/".concat(e)),create:e=>n.post("/suppliers",e),update:(e,t)=>n.put("/suppliers/".concat(e),t),delete:e=>n.delete("/suppliers/".concat(e))},u={getAll:()=>n.get("/integrations"),get:e=>n.get("/integrations/".concat(e)),connect:(e,t)=>n.post("/integrations/".concat(e,"/connect"),t),disconnect:e=>n.post("/integrations/".concat(e,"/disconnect")),updateSettings:(e,t)=>n.patch("/integrations/".concat(e,"/settings"),t),syncProducts:e=>n.post("/integrations/".concat(e,"/sync-products")),syncOrders:e=>n.post("/integrations/".concat(e,"/sync-orders"))},p={get:()=>n.get("/tier-settings"),update:e=>n.put("/tier-settings",{tiers:e})}},229:function(e,t,s){"use strict";s.d(t,{AQ:function(){return l},cL:function(){return i},p6:function(){return o},tN:function(){return r},xG:function(){return c}});var n=s(8433),a=s(189);let r=(0,n.Ue)((e,t)=>({user:null,shop:null,token:localStorage.getItem("token"),isLoading:!0,isAuthenticated:!1,login:async(t,s)=>{let{data:n}=await a.kv.login({email:t,password:s});localStorage.setItem("token",n.token),e({user:n.user,shop:n.shop,token:n.token,isAuthenticated:!0,isLoading:!1})},register:async t=>{let{data:s}=await a.kv.register(t);localStorage.setItem("token",s.token),e({user:s.user,shop:s.shop,token:s.token,isAuthenticated:!0,isLoading:!1})},logout:()=>{localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})},fetchUser:async()=>{let t=localStorage.getItem("token");if(!t){e({isLoading:!1,isAuthenticated:!1});return}try{let{data:s}=await a.kv.getMe();e({user:s.user,shop:s.shop,token:t,isAuthenticated:!0,isLoading:!1})}catch(t){localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})}},setAuth:(t,s,n)=>{localStorage.setItem("token",n),e({user:t,shop:s,token:n,isAuthenticated:!0,isLoading:!1})},setShop:t=>{e({shop:t})}})),c=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s={day:"2-digit",month:"2-digit",year:"numeric"};return t&&(s.hour="2-digit",s.minute="2-digit"),new Date(e).toLocaleDateString("vi-VN",s)},i={pending:"Chờ xử l\xfd",processing:"Đang xử l\xfd",shipping:"Đang giao",completed:"Ho\xe0n th\xe0nh",cancelled:"Đ\xe3 hủy"},l={pending:"warning",processing:"primary",shipping:"primary",completed:"success",cancelled:"danger"}}},function(e){e.O(0,[798,260,115,141,744],function(){return e(e.s=4414)}),_N_E=e.O()}]);