(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[857],{7421:function(e,t,s){Promise.resolve().then(s.bind(s,9815))},9815:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var n=s(7821),a=s(8078),r=s(6871),c=s.n(r),l=s(3910),i=s(2080),o=s(775),d=s(8037),h=s(5032),u=s(189),m=s(229),p=s(7485);function g(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[g,x]=(0,a.useState)(""),[j,b]=(0,a.useState)(!1),[N,f]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null),[k,w]=(0,a.useState)([]),[S,C]=(0,a.useState)([]),[I,A]=(0,a.useState)([]),[D,P]=(0,a.useState)({customerId:"",customerName:"",customerPhone:"",customerEmail:"",customerSource:"instagram",paymentMethod:"cod",shippingFee:0,shippingAddress:"",note:""}),[E,_]=(0,a.useState)(null),T=async()=>{try{let{data:e}=await u.g3.getAll({status:g||void 0,limit:100});t(e.orders)}catch(e){console.error("Failed to fetch orders:",e)}finally{r(!1)}};(0,a.useEffect)(()=>{T()},[g]);let q=async()=>{try{let[e,t]=await Promise.all([u.fU.getAll({limit:100}),u.F3.getAll({limit:100})]);w(e.data.customers),C(t.data.products.filter(e=>e.quantity>0)),A([]),P({customerId:"",customerName:"",customerPhone:"",customerEmail:"",customerSource:"instagram",paymentMethod:"cod",shippingFee:0,shippingAddress:"",note:""}),_(null),b(!0)}catch(e){p.default.error("Kh\xf4ng thể tải dữ liệu")}},L=e=>{if(!e)return;let t=S.find(t=>t._id===e);if(!t)return;let s=I.find(t=>t.productId===e);s?s.quantity<t.quantity?A(I.map(t=>t.productId===e?{...t,quantity:t.quantity+1}:t)):p.default.error("Kh\xf4ng đủ h\xe0ng trong kho"):A([...I,{productId:e,productName:t.name,price:t.price,quantity:1,maxStock:t.quantity}])},F=async e=>{if(e.preventDefault(),0===I.length){p.default.error("Vui l\xf2ng th\xeam \xedt nhất 1 sản phẩm");return}if(!D.customerName||!D.customerPhone){p.default.error("Vui l\xf2ng nhập t\xean v\xe0 SĐT kh\xe1ch h\xe0ng");return}let t=!1;D.customerId&&E&&(D.customerName!==E.name||D.customerPhone!==E.phone||D.customerEmail!==E.email||D.shippingAddress!==E.address)&&(t=confirm("Bạn đ\xe3 sửa th\xf4ng tin kh\xe1ch h\xe0ng. C\xf3 muốn cập nhật v\xe0o hồ sơ kh\xe1ch h\xe0ng kh\xf4ng?"));try{t&&D.customerId&&await u.fU.update(D.customerId,{name:D.customerName,phone:D.customerPhone,email:D.customerEmail,address:D.shippingAddress}),await u.g3.create({customerId:D.customerId||"",customerName:D.customerName,customerPhone:D.customerPhone,customerEmail:D.customerEmail,customerSource:D.customerSource,paymentMethod:D.paymentMethod,shippingFee:D.shippingFee,shippingAddress:D.shippingAddress,note:D.note,items:I.map(e=>({productId:e.productId,quantity:e.quantity}))}),p.default.success(t?"Đ\xe3 tạo đơn h\xe0ng & cập nhật th\xf4ng tin KH":"Đ\xe3 tạo đơn h\xe0ng"),b(!1),_(null),T()}catch(e){p.default.error(e.message||"C\xf3 lỗi xảy ra")}},G=async(e,t)=>{try{if(await u.g3.updateStatus(e,t),p.default.success("Đ\xe3 cập nhật trạng th\xe1i"),T(),(null==y?void 0:y._id)===e){let{data:t}=await u.g3.getById(e);v(t)}}catch(e){p.default.error(e.message||"C\xf3 lỗi xảy ra")}},K=async e=>{if(confirm("Bạn c\xf3 chắc muốn hủy đơn h\xe0ng n\xe0y?"))try{await u.g3.cancel(e,"Hủy bởi admin"),p.default.success("Đ\xe3 hủy đơn h\xe0ng"),T()}catch(e){p.default.error(e.message||"C\xf3 lỗi xảy ra")}},Z=I.reduce((e,t)=>e+t.price*t.quantity,0);return(0,n.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Đơn h\xe0ng"}),(0,n.jsxs)("button",{className:"btn btn-primary",onClick:q,children:[(0,n.jsx)(l.Z,{className:"w-5 h-5"})," Tạo đơn h\xe0ng"]})]}),(0,n.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,n.jsx)("button",{className:"btn ".concat(""===g?"btn-primary":"btn-secondary"),onClick:()=>x(""),children:"Tất cả"}),Object.entries(m.cL).map(e=>{let[t,s]=e;return(0,n.jsx)("button",{className:"btn ".concat(g===t?"btn-primary":"btn-secondary"),onClick:()=>x(t),children:s},t)})]}),(0,n.jsx)("div",{className:"table-container",children:s?(0,n.jsx)("div",{className:"p-8 text-center",children:(0,n.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===e.length?(0,n.jsx)("div",{className:"p-8 text-center text-dark-500",children:"Kh\xf4ng c\xf3 đơn h\xe0ng"}):(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"M\xe3 đơn"}),(0,n.jsx)("th",{children:"Kh\xe1ch h\xe0ng"}),(0,n.jsx)("th",{children:"Sản phẩm"}),(0,n.jsx)("th",{children:"Tổng tiền"}),(0,n.jsx)("th",{children:"Trạng th\xe1i"}),(0,n.jsx)("th",{children:"Ng\xe0y tạo"}),(0,n.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,n.jsx)("tbody",{children:e.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"font-medium",children:e.orderCode}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:e.customerName||"Kh\xe1ch v\xe3ng lai"}),(0,n.jsx)("p",{className:"text-sm text-dark-500",children:e.customerPhone})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("span",{className:"badge badge-gray",children:[e.items.length," SP"]})}),(0,n.jsx)("td",{className:"font-medium text-green-400",children:(0,m.xG)(e.total)}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"badge badge-".concat(m.AQ[e.status]),children:m.cL[e.status]})}),(0,n.jsx)("td",{className:"text-dark-400",children:(0,m.p6)(e.createdAt)}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(c(),{href:"/dashboard/orders/".concat(e._id),className:"btn btn-ghost p-2",title:"Xem chi tiết & in",children:(0,n.jsx)(i.Z,{className:"w-4 h-4"})}),"pending"===e.status&&(0,n.jsx)("button",{className:"btn btn-ghost p-2 text-green-400",title:"X\xe1c nhận đơn h\xe0ng",onClick:()=>G(e._id,"processing"),children:(0,n.jsx)(o.Z,{className:"w-4 h-4"})}),"processing"===e.status&&(0,n.jsx)("button",{className:"btn btn-ghost p-2 text-blue-400",title:"Bắt đầu giao h\xe0ng",onClick:()=>G(e._id,"shipping"),children:(0,n.jsx)(d.Z,{className:"w-4 h-4"})}),"shipping"===e.status&&(0,n.jsx)("button",{className:"btn btn-ghost p-2 text-green-400",title:"Ho\xe0n th\xe0nh đơn h\xe0ng",onClick:()=>G(e._id,"completed"),children:(0,n.jsx)(o.Z,{className:"w-4 h-4"})}),["pending","processing","shipping"].includes(e.status)&&(0,n.jsx)("button",{className:"btn btn-ghost p-2 text-red-400",title:"Hủy đơn h\xe0ng",onClick:()=>K(e._id),children:(0,n.jsx)(h.Z,{className:"w-4 h-4"})})]})})]},e._id))})]})}),j&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"p-4 border-b border-dark-800 flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Tạo đơn h\xe0ng mới"}),(0,n.jsx)("button",{type:"button",className:"btn btn-ghost p-2",onClick:()=>b(!1),children:(0,n.jsx)(h.Z,{className:"w-5 h-5"})})]}),(0,n.jsxs)("form",{onSubmit:F,className:"p-4",children:[(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-primary-400 border-b border-dark-700 pb-2",children:"\uD83D\uDC64 Th\xf4ng tin kh\xe1ch h\xe0ng"}),(0,n.jsxs)("div",{className:"space-y-3 p-3 bg-dark-800 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-xs text-dark-400",children:"Nhập SĐT hoặc T\xean để t\xecm KH"}),D.customerId&&(0,n.jsx)("button",{type:"button",className:"px-2 py-1 text-xs bg-red-500/20 text-red-400 hover:bg-red-500/40 rounded-md border border-red-500/40 transition-colors font-medium",onClick:()=>P({...D,customerId:"",customerName:"",customerPhone:"",customerEmail:"",shippingAddress:""}),children:"✕ X\xf3a & nhập mới"})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("label",{className:"label",children:"Số điện thoại *"}),(0,n.jsx)("input",{className:"input",required:!0,placeholder:"Nhập SĐT để t\xecm hoặc tạo mới",value:D.customerPhone,onChange:e=>P({...D,customerPhone:e.target.value})}),D.customerPhone&&!D.customerId&&D.customerPhone.length>=3&&(()=>{let e=k.filter(e=>e.phone.includes(D.customerPhone)).slice(0,5);return e.length>0?(0,n.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-dark-900 border border-dark-700 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:e.map(e=>(0,n.jsxs)("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-dark-700 flex items-center gap-2 text-sm",onClick:()=>{P({...D,customerId:e._id,customerName:e.name,customerPhone:e.phone,customerEmail:e.email||"",shippingAddress:e.address||D.shippingAddress}),_({name:e.name,phone:e.phone,email:e.email||"",address:e.address||""})},children:[(0,n.jsx)("span",{className:"text-primary-400",children:e.phone}),(0,n.jsx)("span",{className:"text-dark-400",children:"-"}),(0,n.jsx)("span",{children:e.name})]},e._id))}):null})(),D.customerId&&(0,n.jsxs)("p",{className:"text-xs text-green-400 mt-1",children:["✓ Kh\xe1ch h\xe0ng cũ: ",D.customerName]})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("label",{className:"label",children:"T\xean kh\xe1ch h\xe0ng *"}),(0,n.jsx)("input",{className:"input",required:!0,placeholder:"Nguyễn Văn A",value:D.customerName,onChange:e=>P({...D,customerName:e.target.value})}),D.customerName&&!D.customerId&&D.customerName.length>=2&&(()=>{let e=k.filter(e=>e.name.toLowerCase().includes(D.customerName.toLowerCase())).slice(0,5);return e.length>0?(0,n.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-dark-900 border border-dark-700 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:e.map(e=>(0,n.jsxs)("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-dark-700 flex items-center gap-2 text-sm",onClick:()=>{P({...D,customerId:e._id,customerName:e.name,customerPhone:e.phone,customerEmail:e.email||"",shippingAddress:e.address||D.shippingAddress}),_({name:e.name,phone:e.phone,email:e.email||"",address:e.address||""})},children:[(0,n.jsx)("span",{className:"text-primary-400",children:e.name}),(0,n.jsx)("span",{className:"text-dark-400",children:"-"}),(0,n.jsx)("span",{children:e.phone})]},e._id))}):null})()]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Địa chỉ giao h\xe0ng *"}),(0,n.jsx)("textarea",{className:"input",rows:2,required:!0,value:D.shippingAddress,onChange:e=>P({...D,shippingAddress:e.target.value}),placeholder:"Số nh\xe0, đường, quận/huyện, tỉnh/th\xe0nh"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Email (t\xf9y chọn)"}),(0,n.jsx)("input",{type:"email",className:"input",placeholder:"email@example.com",value:D.customerEmail,onChange:e=>P({...D,customerEmail:e.target.value})})]}),!D.customerId&&D.customerPhone&&D.customerName&&(0,n.jsx)("p",{className:"text-xs text-yellow-400",children:"⚡ Kh\xe1ch h\xe0ng mới - sẽ tự động lưu khi tạo đơn"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Nguồn kh\xe1ch"}),(0,n.jsxs)("select",{className:"input",value:D.customerSource,onChange:e=>P({...D,customerSource:e.target.value}),children:[(0,n.jsx)("option",{value:"instagram",children:"\uD83D\uDCF7 Instagram"}),(0,n.jsx)("option",{value:"facebook",children:"\uD83D\uDCD8 Facebook"}),(0,n.jsx)("option",{value:"other",children:"\uD83D\uDCF1 Kh\xe1c"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Thanh to\xe1n"}),(0,n.jsxs)("select",{className:"input",value:D.paymentMethod,onChange:e=>P({...D,paymentMethod:e.target.value}),children:[(0,n.jsx)("option",{value:"cod",children:"\uD83D\uDCB5 COD"}),(0,n.jsx)("option",{value:"transfer",children:"\uD83C\uDFE6 Chuyển khoản"}),(0,n.jsx)("option",{value:"cash",children:"� Tiền mặt"})]})]})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-primary-400 border-b border-dark-700 pb-2",children:"\uD83D\uDED2 Sản phẩm & Thanh to\xe1n"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Th\xeam sản phẩm"}),(0,n.jsxs)("select",{className:"input",onChange:e=>{L(e.target.value),e.target.value=""},children:[(0,n.jsx)("option",{value:"",children:"-- Chọn sản phẩm --"}),S.map(e=>(0,n.jsxs)("option",{value:e._id,children:[e.name," - ",(0,m.xG)(e.price)," (SL: ",e.quantity,")"]},e._id))]})]}),I.length>0&&(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Sản phẩm"}),(0,n.jsx)("th",{children:"Số lượng"}),(0,n.jsx)("th",{children:"Th\xe0nh tiền"}),(0,n.jsx)("th",{})]})}),(0,n.jsx)("tbody",{children:I.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.productName}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"number",className:"input w-20",min:"1",max:e.maxStock,value:e.quantity,onChange:e=>A(I.map((s,n)=>n===t?{...s,quantity:parseInt(e.target.value)||1}:s))})}),(0,n.jsx)("td",{children:(0,m.xG)(e.price*e.quantity)}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{type:"button",className:"btn btn-ghost p-1 text-red-400",onClick:()=>A(I.filter((e,s)=>s!==t)),children:(0,n.jsx)(h.Z,{className:"w-4 h-4"})})})]},t))})]})}),(0,n.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 space-y-3",children:[(0,n.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,n.jsxs)("span",{className:"text-dark-400",children:["Tạm t\xednh (",I.length," SP):"]}),(0,n.jsx)("span",{children:(0,m.xG)(Z)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,n.jsx)("span",{className:"text-dark-400",children:"Ph\xed ship:"}),(0,n.jsx)("input",{type:"text",className:"input w-32 text-right",placeholder:"0",value:D.shippingFee?Number(String(D.shippingFee).replace(/\./g,"")).toLocaleString("vi-VN"):"",onChange:e=>{let t=e.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");P({...D,shippingFee:parseInt(t)||0})}})]}),(0,n.jsxs)("div",{className:"flex justify-between text-lg font-bold border-t border-dark-700 pt-3",children:[(0,n.jsx)("span",{children:"Tổng cộng:"}),(0,n.jsx)("span",{className:"text-green-400",children:(0,m.xG)(Z+(D.shippingFee||0))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:"Ghi ch\xfa"}),(0,n.jsx)("textarea",{className:"input",rows:2,value:D.note,onChange:e=>P({...D,note:e.target.value}),placeholder:"Ghi ch\xfa cho đơn h\xe0ng..."})]})]})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-dark-800 mt-4",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary flex-1",onClick:()=>b(!1),children:"Hủy"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary flex-1",children:"\uD83D\uDED2 Tạo đơn h\xe0ng"})]})]})]})}),N&&y&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-dark-900 border border-dark-800 rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"p-4 border-b border-dark-800 flex justify-between items-center",children:[(0,n.jsxs)("h2",{className:"text-lg font-semibold",children:["Chi tiết đơn h\xe0ng ",y.orderCode]}),(0,n.jsx)("span",{className:"badge badge-".concat(m.AQ[y.status]),children:m.cL[y.status]})]}),(0,n.jsxs)("div",{className:"p-4 space-y-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4 bg-dark-800 rounded-lg",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-dark-500 text-sm",children:"Kh\xe1ch h\xe0ng"}),(0,n.jsx)("p",{className:"font-medium",children:y.customerName||"-"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-dark-500 text-sm",children:"Điện thoại"}),(0,n.jsx)("p",{className:"font-medium",children:y.customerPhone||"-"})]}),(0,n.jsxs)("div",{className:"col-span-2",children:[(0,n.jsx)("p",{className:"text-dark-500 text-sm",children:"Địa chỉ"}),(0,n.jsx)("p",{className:"font-medium",children:y.shippingAddress})]})]}),(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Sản phẩm"}),(0,n.jsx)("th",{className:"text-right",children:"Đơn gi\xe1"}),(0,n.jsx)("th",{className:"text-center",children:"SL"}),(0,n.jsx)("th",{className:"text-right",children:"Th\xe0nh tiền"})]})}),(0,n.jsxs)("tbody",{children:[y.items.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.productName}),(0,n.jsx)("td",{className:"text-right",children:(0,m.xG)(e.price)}),(0,n.jsx)("td",{className:"text-center",children:e.quantity}),(0,n.jsx)("td",{className:"text-right font-medium",children:(0,m.xG)(e.price*e.quantity)})]},t)),(0,n.jsxs)("tr",{className:"bg-dark-800",children:[(0,n.jsx)("td",{colSpan:3,className:"text-right font-semibold",children:"Tổng cộng:"}),(0,n.jsx)("td",{className:"text-right font-bold text-green-400",children:(0,m.xG)(y.total)})]})]})]})}),!["completed","cancelled"].includes(y.status)&&(0,n.jsxs)("div",{className:"flex gap-2 flex-wrap",children:["pending"===y.status&&(0,n.jsx)("button",{className:"btn btn-primary",onClick:()=>G(y._id,"processing"),children:"X\xe1c nhận"}),"processing"===y.status&&(0,n.jsx)("button",{className:"btn btn-primary",onClick:()=>G(y._id,"shipping"),children:"Giao h\xe0ng"}),"shipping"===y.status&&(0,n.jsx)("button",{className:"btn btn-primary",onClick:()=>G(y._id,"completed"),children:"Ho\xe0n th\xe0nh"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:()=>{K(y._id),f(!1)},children:"Hủy đơn"})]})]}),(0,n.jsx)("div",{className:"p-4 border-t border-dark-800",children:(0,n.jsx)("button",{className:"btn btn-secondary w-full",onClick:()=>f(!1),children:"Đ\xf3ng"})})]})})]})}},189:function(e,t,s){"use strict";s.d(t,{F3:function(){return r},IK:function(){return h},Z9:function(){return o},ZE:function(){return d},fU:function(){return c},g3:function(){return l},kv:function(){return a},v2:function(){return u},vD:function(){return i}});let n=s(1892).Z.create({baseURL:"http://localhost:8080/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),n.interceptors.response.use(e=>e,e=>{var t,s,n,a,r,c;let l=(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Đ\xe3 xảy ra lỗi";return(null===(a=e.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.code)==="LICENSE_EXPIRED"&&(window.location.href="/license-expired"),(null===(r=e.response)||void 0===r?void 0:r.status)===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject({message:l,...null===(c=e.response)||void 0===c?void 0:c.data})});let a={register:e=>n.post("/auth/register",e),login:e=>n.post("/auth/login",e),getMe:()=>n.get("/auth/me"),verifyEmail:e=>n.get("/auth/verify-email/".concat(e)),forgotPassword:e=>n.post("/auth/forgot-password",{email:e}),resetPassword:(e,t)=>n.post("/auth/reset-password/".concat(e),{password:t}),updateShop:e=>n.put("/auth/shop",e),changePassword:(e,t)=>n.put("/auth/change-password",{currentPassword:e,newPassword:t})},r={getAll:e=>n.get("/products",{params:e}),getById:e=>n.get("/products/".concat(e)),create:e=>n.post("/products",e),update:(e,t)=>n.put("/products/".concat(e),t),delete:e=>n.delete("/products/".concat(e)),getCategories:()=>n.get("/products/categories"),getLowStock:()=>n.get("/products/low-stock"),updateStock:(e,t,s)=>n.patch("/products/".concat(e,"/stock"),{adjustment:t,reason:s})},c={getAll:e=>n.get("/customers",{params:e}),getById:e=>n.get("/customers/".concat(e)),create:e=>n.post("/customers",e),update:(e,t)=>n.put("/customers/".concat(e),t),delete:e=>n.delete("/customers/".concat(e)),getOrders:e=>n.get("/customers/".concat(e,"/orders"))},l={getAll:e=>n.get("/orders",{params:e}),getById:e=>n.get("/orders/".concat(e)),create:e=>n.post("/orders",e),updateStatus:(e,t,s)=>n.patch("/orders/".concat(e,"/status"),{status:t,note:s}),cancel:(e,t)=>n.post("/orders/".concat(e,"/cancel"),{reason:t}),getStats:()=>n.get("/orders/stats")},i={getStats:()=>n.get("/dashboard/stats"),getRevenue:e=>n.get("/dashboard/revenue",{params:e}),getTopProducts:e=>n.get("/dashboard/top-products",{params:{limit:e}}),getRecentOrders:e=>n.get("/dashboard/recent-orders",{params:{limit:e}})},o={getAll:()=>n.get("/staff"),create:e=>n.post("/staff",e),update:(e,t)=>n.put("/staff/".concat(e),t),delete:e=>n.delete("/staff/".concat(e)),resetPassword:(e,t)=>n.post("/staff/".concat(e,"/reset-password"),{newPassword:t})},d={getAll:e=>n.get("/suppliers",{params:e}),getById:e=>n.get("/suppliers/".concat(e)),create:e=>n.post("/suppliers",e),update:(e,t)=>n.put("/suppliers/".concat(e),t),delete:e=>n.delete("/suppliers/".concat(e))},h={getAll:()=>n.get("/integrations"),get:e=>n.get("/integrations/".concat(e)),connect:(e,t)=>n.post("/integrations/".concat(e,"/connect"),t),disconnect:e=>n.post("/integrations/".concat(e,"/disconnect")),updateSettings:(e,t)=>n.patch("/integrations/".concat(e,"/settings"),t),syncProducts:e=>n.post("/integrations/".concat(e,"/sync-products")),syncOrders:e=>n.post("/integrations/".concat(e,"/sync-orders"))},u={get:()=>n.get("/tier-settings"),update:e=>n.put("/tier-settings",{tiers:e})}},229:function(e,t,s){"use strict";s.d(t,{AQ:function(){return o},cL:function(){return i},p6:function(){return l},tN:function(){return r},xG:function(){return c}});var n=s(8433),a=s(189);let r=(0,n.Ue)((e,t)=>({user:null,shop:null,token:localStorage.getItem("token"),isLoading:!0,isAuthenticated:!1,login:async(t,s)=>{let{data:n}=await a.kv.login({email:t,password:s});localStorage.setItem("token",n.token),e({user:n.user,shop:n.shop,token:n.token,isAuthenticated:!0,isLoading:!1})},register:async t=>{let{data:s}=await a.kv.register(t);localStorage.setItem("token",s.token),e({user:s.user,shop:s.shop,token:s.token,isAuthenticated:!0,isLoading:!1})},logout:()=>{localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})},fetchUser:async()=>{let t=localStorage.getItem("token");if(!t){e({isLoading:!1,isAuthenticated:!1});return}try{let{data:s}=await a.kv.getMe();e({user:s.user,shop:s.shop,token:t,isAuthenticated:!0,isLoading:!1})}catch(t){localStorage.removeItem("token"),e({user:null,shop:null,token:null,isAuthenticated:!1,isLoading:!1})}},setAuth:(t,s,n)=>{localStorage.setItem("token",n),e({user:t,shop:s,token:n,isAuthenticated:!0,isLoading:!1})},setShop:t=>{e({shop:t})}})),c=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s={day:"2-digit",month:"2-digit",year:"numeric"};return t&&(s.hour="2-digit",s.minute="2-digit"),new Date(e).toLocaleDateString("vi-VN",s)},i={pending:"Chờ xử l\xfd",processing:"Đang xử l\xfd",shipping:"Đang giao",completed:"Ho\xe0n th\xe0nh",cancelled:"Đ\xe3 hủy"},o={pending:"warning",processing:"primary",shipping:"primary",completed:"success",cancelled:"danger"}}},function(e){e.O(0,[798,871,470,115,141,744],function(){return e(e.s=7421)}),_N_E=e.O()}]);